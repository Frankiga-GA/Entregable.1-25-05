<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>entrenando con Juan GAAAAAA</title>
</head>

<body>
  <script src="https://cdn.jsdelivr.net/npm/p5@1.4.0/lib/p5.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/ml5@0.12.2/dist/ml5.min.js"></script>
  <script>
    let Trectangulo = [];
    let acutangulo = [];
    let AcutanguloVolteado = [];

    let clasificador;

    function preload() {
      for (let n = 1; n <= 100; n++) {
        const numStr = n.toString().padStart(3, '0');
        Trectangulo.push(loadImage(`processing/triangles/data/triangulo_rectangulo/triangle${numStr}.png`));
        acutangulo.push(loadImage(`processing/triangles/data/acutangulo/triangle${numStr}.png`));
        AcutanguloVolteado.push(loadImage(`processing/triangles/data/acutangulo_volteado/triangle${numStr}.png`));

      }
    }

    function setup() {
      noCanvas();
      clasificador = ml5.neuralNetwork({
        inputs: [48, 48, 4],
        task: 'imageClassification',
        debug: true
      });
      for (let i = 0; i < 100; i++) {
        clasificador.addData({ image: Trectangulo[i] }, { label: "Triángulo Rectángulo" });
        clasificador.addData({ image: acutangulo[i] }, { label: "Triángulo Acutángulo" });
        clasificador.addData({ image: AcutanguloVolteado[i] }, { label: "Triángulo Acutángulo de cabeza" });
      }
      clasificador.normalizeData();
      clasificador.train({ epochs: 50 }, onTrainComplete);
    }

    function onTrainComplete() {
      console.log("Entrenamiento completado");
      clasificador.save();
    }
  </script>
</body>

</html>

